"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/base.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-tree.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-checkbox.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-button.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-button-group.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-popper.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-scrollbar.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-dropdown.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-dropdown-menu.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-dropdown-item.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-link.css.js");require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/theme-chalk/el-input.css.js");const z=require("../SvgIcon/index.vue.js"),l=require("vue"),F=require("./defaults.js");require("./FmoneTree.vue2.js");const H=require("../../../_virtual/_plugin-vue_export-helper.js"),U=require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/es/components/input/index.js"),G=require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/es/components/link/index.js"),L=require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/es/components/dropdown/index.js"),J=require("../../../node_modules/.pnpm/registry.npmmirror.com_element-plus@2.7.0_vue@3.4.21/node_modules/element-plus/es/components/tree/index.js"),Q=l.defineComponent({name:"FmoneTree",components:{},props:F.default,setup(e,{emit:a,expose:V}){const v=l.ref(),u=l.ref(),w=l.ref(""),c=l.ref("");c.value=e.defaultProps.label;const f=l.ref(!1),h=l.computed(()=>e.menulist),p=n=>{u.value.filter(n)};l.watch(()=>e.datalist,async n=>{w.value!==""&&(await l.nextTick(),p(w.value))},{immediate:!0});const C=(n,t)=>n?t[c.value].includes(n):!0,i=l.ref({}),s=l.ref({}),N=(n,t)=>{if(i.value=n,s.value=t,!e.specialKey)f.value=!0;else{let o=h.value.filter(d=>!d.special||e.specialKey&&!i.value[e.specialKey]);f.value=o.length>0}a("node-click",n,t)},r=()=>{u.value.setCurrentKey(null),i.value={},s.value={},a("headerbutton")},k=n=>{a(n,i.value)},y=l.ref(!0),D=()=>{v.value.classList.contains("tree-expand")?(v.value.classList.remove("tree-expand"),v.value.classList.add("tree-collapse")):(v.value.classList.remove("tree-collapse"),v.value.classList.add("tree-expand")),y.value=!y.value,a("showtreeClick",y.value)},q=(n,t)=>{if(u.value.setCurrentKey(n),t)if(i.value=t.data,s.value=t,!e.specialKey)f.value=!0;else{let o=h.value.filter(d=>!d.special||e.specialKey&&!i.value[e.specialKey]);f.value=o.length>0}},K=()=>{u.value.setCurrentKey(),i.value={},s.value={}},m=l.ref([]),A=n=>{m.value.includes(n)||m.value.push(n)},S=n=>{m.value.push(n.nodeKey)},g=(n,t)=>{T(t)},T=n=>{var t=m.value.indexOf(n.data.nodeKey);t!=-1&&m.value.splice(t,1),n.childNodes.forEach(o=>{T(o)})},$=()=>u.value.getCurrentNode(),B=()=>u.value.getCurrentKey(),O=n=>u.value.getNode(n),I=(n,t,o)=>e.internalTree?n.parent.data[e.nodekey]===dropNode.data[e.nodekey]&&o==="inner"||n.parent.data[e.nodekey]===dropNode.parent.data[e.nodekey]&&o!=="inner"?!(n.level>dropNode.level):!1:!(e.signLevelTree&&o==="inner"||e.doubleLevelTree&&dropNode.level===2&&o=="inner"||e.doubleLevelTree&&dropNode.level===1&&n.childNodes.length!=0&&o=="inner"||e.doubleLevelTree&&n.childNodes.length!=0&&dropNode.level===2&&o!="inner"||e.sameLevelTree&&(n.level!==dropNode.level||n.level===dropNode.level&&(n.parent.data.id!==dropNode.parent.data.id||o=="inner"))||e.doubleSameLevelTree&&(n.level!==dropNode.level||n.level===dropNode.level&&o==="inner")||n.data.preset||dropNode.data.preset),P=n=>e.internalTree?n.level!==1:!0,E={before:"moveBefore",after:"moveAfter",inner:"appendChild"},_=(n,t,o)=>{if(console.log(n,t),o==="inner"){const d=t;let b=null;d.childNodes&&d.childNodes.length>1&&(b=d.childNodes[d.childNodes.length-2]),console.log(b,d),a("drop-end",n,b,E[o],d)}else a("drop-end",n,t,E[o])};V({inputchange:p,setCurrentKey:q,setExpandedKeys:A,getCurrentNode:$,getCurrentKey:B,getNode:O,removeSelectNode:K,handleNodeClick:N});const M=n=>{if(n&&n.length>0){const t=n;return permissions.includes("*:*:*")?!0:permissions.some(o=>t.includes(o))}},j=l.computed(()=>h.value.filter(t=>M([t.haspermissionkey])&&(!e.specialKey&&e.maxLevel===1/0||!t.special||e.specialKey&&!i.value[e.specialKey]||t.special&&e.maxLevel!==1/0&&s.value.level<e.maxLevel)&&(!e.internalTree||e.internalTree&&t.topLevelOpt&&s.value.level===1||e.internalTree&&t.nextLevelOpt&&s.value.level>1)&&(!e.doubleLevelTree||e.doubleLevelTree&&t.topLevelOpt&&s.value.level===1||e.doubleLevelTree&&t.nextLevelOpt&&s.value.level>1)).length!==0);return{fmoneTree:v,eltree:u,currentNodeData:i,currentNode:s,preset:f,menuList:h,defaultPropLabel:c,filterInput:w,showtree:y,expandedKeys:m,headerbutton:r,inputchange:p,filterNode:C,handleNodeClick:N,handleCommand:k,collapsetree:D,handleNodeExpand:S,handleNodeCollapse:g,allowDrop:I,allowDrag:P,handleDrop:_,leastOne:j}}}),R={class:"fmcoe-tree tree-expand",ref:"fmoneTree"},W={class:"fmcoe-tree-show"},X={class:"tree-header"},Y={class:"titlestyle"},Z={key:0,class:"sub-title"},x={class:"scroll-content"},ee={class:"custom-tree-node"},le=["title"],ne={key:0,style:{margin:"0 18px",width:"12px"}};function te(e,a,V,v,u,w){const c=z.default,f=U.ElInput,h=G.ElLink,p=L.ElDropdownItem,C=L.ElDropdownMenu,i=L.ElDropdown,s=J.ElTree,N=l.resolveDirective("has-permission");return l.openBlock(),l.createElementBlock("div",R,[l.createVNode(l.Transition,{name:"el-fade-in"},{default:l.withCtx(()=>[l.withDirectives(l.createElementVNode("div",W,[l.createElementVNode("div",{class:"rightsvg",onClick:a[0]||(a[0]=(...r)=>e.collapsetree&&e.collapsetree(...r))},[l.createVNode(c,{class:"sub-select-icon","icon-name":"icon-shousuojiantouzuo",color:"#A0A0A0"})]),l.createElementVNode("div",X,[l.createElementVNode("span",Y,l.toDisplayString(e.title),1),l.withDirectives(l.createVNode(c,{class:"sub-select-icon",onClick:e.headerbutton,size:"17px","icon-name":e.iconname,color:"#A0A0A0"},null,8,["onClick","icon-name"]),[[N,[e.savePermission]],[l.vShow,e.titleshow]])]),e.$slots.subTitle?(l.openBlock(),l.createElementBlock("div",Z,[l.renderSlot(e.$slots,"subTitle")])):l.createCommentVNode("",!0),e.onSearch?l.renderSlot(e.$slots,"treeSearch",{key:1},()=>[e.onSearch?(l.openBlock(),l.createBlock(f,{key:0,modelValue:e.filterInput,"onUpdate:modelValue":a[1]||(a[1]=r=>e.filterInput=r),class:"fmone-tree-search",placeholder:e.$t("common.placeholder.search"),onInput:e.inputchange},{prefix:l.withCtx(()=>[l.createVNode(c,{class:"sub-select-icon","icon-name":"icon-sousuo",color:"#A0A0A0"})]),_:1},8,["modelValue","placeholder","onInput"])):l.createCommentVNode("",!0)]):l.createCommentVNode("",!0),l.createElementVNode("div",x,[l.createVNode(s,{ref:"eltree",data:e.datalist,props:e.defaultProps,"node-key":e.nodekey,"highlight-current":e.highlight,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"current-node-key":e.currentNodeKey,"default-expanded-keys":e.expandedKeys,draggable:e.draggable,"allow-drag":e.allowDrag,"allow-drop":e.allowDrop,onNodeClick:e.handleNodeClick,onNodeExpand:e.handleNodeExpand,onNodeCollapse:e.handleNodeCollapse,onNodeDrop:e.handleDrop,style:{flex:"1"}},{default:l.withCtx(({node:r})=>[l.createElementVNode("span",ee,[l.createElementVNode("span",{class:"text-ellipsis",title:r.label,style:{width:"calc(100% - 48px)"}},[l.renderSlot(e.$slots,"label",{node:r},()=>[l.createTextVNode(l.toDisplayString(r.label==="All"?e.$t(r.label):r.label),1)])],8,le),(e.currentNodeData[e.nodekey]&&e.currentNodeData[e.nodekey]===r.data[e.nodekey]||e.currentNode.data&&r.data.id===e.currentNode.data.id&&r.level===e.currentNode.level)&&e.menuList.length>0&&e.preset&&e.leastOne?l.withDirectives((l.openBlock(),l.createElementBlock("span",ne,[l.createVNode(i,{style:{"line-height":"40px",display:"inline-block"},onCommand:e.handleCommand},{dropdown:l.withCtx(()=>[l.createVNode(C,{class:"dropdownmeunstyle"},{default:l.withCtx(()=>[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.menuList,(k,y)=>(l.openBlock(),l.createBlock(p,{key:k.clickname,command:k.clickname},{default:l.withCtx(()=>[l.createTextVNode(l.toDisplayString(k.name),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:l.withCtx(()=>[l.createVNode(h,null,{default:l.withCtx(()=>[l.createVNode(c,{class:"sub-select-icon","icon-name":"icon-shufenleicaozuo",color:"#A0A0A0"})]),_:1})]),_:1},8,["onCommand"])])),[[N,[e.savePermission,e.deletePermission]]]):l.createCommentVNode("",!0)])]),_:3},8,["data","props","node-key","highlight-current","filter-node-method","current-node-key","default-expanded-keys","draggable","allow-drag","allow-drop","onNodeClick","onNodeExpand","onNodeCollapse","onNodeDrop"])])],512),[[l.vShow,e.showtree]])]),_:3}),l.createVNode(l.Transition,{name:"el-fade-in"},{default:l.withCtx(()=>[l.withDirectives(l.createElementVNode("div",{class:"collapse",onClick:a[2]||(a[2]=(...r)=>e.collapsetree&&e.collapsetree(...r))},[l.createVNode(c,{class:"sub-select-icon","icon-name":"icon-shuangjiantouyou",color:"#A0A0A0"})],512),[[l.vShow,!e.showtree]])]),_:1})],512)}const oe=H.default(Q,[["render",te]]);exports.default=oe;
//# sourceMappingURL=FmoneTree.vue.js.map
